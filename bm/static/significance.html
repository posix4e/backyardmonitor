<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8" />
    <title>Significance View</title>
    <link rel="icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg'/%3E">
    <style>
      body { font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif; margin: 16px; }
      .muted { color:#666; }
      .row { display:flex; gap:16px; align-items:flex-start; flex-wrap:wrap; }
      .card { border:1px solid #e6e6e6; border-radius:10px; padding:12px; box-shadow:0 2px 10px rgba(0,0,0,0.05); background:#fff; }
      .imgbox img { max-width: 360px; border:1px solid #eee; border-radius:8px; display:block; }
      .kv { font-family: ui-monospace, SFMono-Regular, Menlo, monospace; font-size:12px; white-space: pre-wrap; }
      .badge { display:inline-block; font-size:12px; background:#111; color:#fff; padding:2px 6px; border-radius:10px; opacity:0.85; }
      .good { background:#0b6; }
      .warn { background:#b00000; }
      .toolbar { display:flex; gap:8px; align-items:center; }
      .toolbar .nav { margin-left:auto; }
    </style>
  </head>
  <body>
    <div class="toolbar">
      <a href="/" title="Back">â¬… Back</a>
      <div style="font-weight:600;">Significance Debug</div>
      <div class="nav muted" id="meta_line"></div>
    </div>
    <div style="margin-top:12px;" class="row">
      <div class="card imgbox">
        <div class="muted" style="margin-bottom:6px;">Previous</div>
        <img id="img_prev" alt="previous" />
        <div class="muted" id="prev_info"></div>
      </div>
      <div class="card imgbox" style="position:relative;">
        <div class="muted" style="margin-bottom:6px;">Current</div>
        <div id="cur_wrap" style="position:relative; display:inline-block;">
          <img id="img_cur" alt="current" />
          <div id="cur_box" style="position:absolute; left:0; top:0; border:2px solid #ff0055; border-radius:4px; display:none; pointer-events:none;"></div>
        </div>
        <div class="muted" id="cur_info"></div>
      </div>
      <div class="card imgbox">
        <div class="muted" style="margin-bottom:6px;">Change Mask</div>
        <img id="img_mask" alt="mask" />
        <div class="muted">Overlay of changed pixels</div>
      </div>
    </div>
    <div class="row" style="margin-top:12px;">
      <div class="card" style="flex:1; min-width:320px;">
        <div style="font-weight:600; margin-bottom:6px;">LLM Input (Prompt)</div>
        <div id="prompt" class="kv"></div>
      </div>
      <div class="card" style="flex:1; min-width:320px;">
        <div style="font-weight:600; margin-bottom:6px;">LLM Output (Raw)</div>
        <div id="response" class="kv"></div>
      </div>
    </div>
    <div class="card" style="margin-top:12px;">
      <div style="font-weight:600; margin-bottom:6px;">Analysis</div>
      <div id="analysis" class="kv"></div>
    </div>
    <div class="card" style="margin-top:12px;">
      <div style="display:flex; gap:8px; align-items:center;">
        <button id="btn_rerun">Re-run analysis</button>
        <span class="muted" id="run_status"></span>
      </div>
    </div>
    <div class="card" style="margin-top:12px;">
      <div style="display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
        <span id="sig_badge" class="badge">Significant</span>
        <span id="status_badge" class="badge">Status</span>
        <span class="muted">Reason:</span>
        <span id="reason" class="kv"></span>
      </div>
      <div class="muted" style="margin-top:6px;">
        Provider/Model: <span id="prov"></span>
      </div>
    </div>
    <script src="/static/js/significance.js"></script>
  </body>
  </html>
